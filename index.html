<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Super Mod Official - Live Stream</title>
<style>
  body {
    margin: 0;
    padding: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: #000;
    font-family: Arial, sans-serif;
    color: white;
    text-align: center;
  }
  h1 { margin-bottom: 10px; }
  .video-container {
    width: 90%;
    max-width: 800px;
    margin-bottom: 20px;
    position: relative;
  }
  video {
    width: 100%;
    border: 2px solid #fff;
    border-radius: 10px;
    display: none;
    background: #000;
  }
  .active { display: block; }
  .server-buttons, .quality-selector { margin-bottom: 15px; }
  button, select, .button {
    background-color: #0088cc;
    color: #fff;
    border: none;
    padding: 10px 15px;
    margin: 5px;
    border-radius: 8px;
    font-size: 15px;
    cursor: pointer;
    transition: background 0.3s;
    text-decoration: none;
  }
  button:hover, .button:hover, select:hover { background-color: #006699; }
</style>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script>
const telegramAppLink = "tg://resolve?domain=SuperModsApk";

const videoSources = {
  server1: "https://vg-republictvlive.akamaized.net/v1/master/611d79b11b77e2f571934fd80ca1413453772ac7/vglive-sk-366023/main.m3u8",
  server2: "https://live-dangal.akamaized.net/liveabr/playlist.m3u8",
  server3: "https://dztlhgid9me95.cloudfront.net/live-tv/Vidgyor/timesnow/timesnow_master.m3u8"
};

let hlsInstances = {}; // Store HLS.js instances
let currentVideo = null;

function switchServer(server) {
  document.querySelectorAll("video").forEach(v => v.classList.remove("active"));
  currentVideo = document.getElementById(server);
  currentVideo.classList.add("active");

  // Destroy previous HLS instance
  if (hlsInstances[server]) hlsInstances[server].destroy();

  if (Hls.isSupported()) {
    const hls = new Hls();
    hls.loadSource(videoSources[server]);
    hls.attachMedia(currentVideo);
    hls.on(Hls.Events.MANIFEST_PARSED, function () {
      currentVideo.play().catch(() => console.log("Click to play."));
      populateQualityOptions(hls);
    });
    hlsInstances[server] = hls;
  } else if (currentVideo.canPlayType('application/vnd.apple.mpegurl')) {
    currentVideo.src = videoSources[server];
    currentVideo.play().catch(() => console.log("Click to play."));
  }
}

// Populate quality dropdown
function populateQualityOptions(hls) {
  const qualitySelect = document.getElementById("quality-select");
  qualitySelect.innerHTML = ""; // clear previous options
  hls.levels.forEach((level, index) => {
    const option = document.createElement("option");
    option.value = index;
    option.text = level.height + "p";
    qualitySelect.appendChild(option);
  });

  qualitySelect.onchange = () => {
    hls.currentLevel = parseInt(qualitySelect.value);
  };
}

window.addEventListener("load", () => {
  if (!sessionStorage.getItem("redirected")) {
    sessionStorage.setItem("redirected", "true");
    setTimeout(() => { window.location.href = telegramAppLink; }, 8000);
  }
  switchServer("server1");
});
</script>
</head>
<body>
<h1>Super Mod Official - Live Stream</h1>

<div class="server-buttons">
  <button onclick="switchServer('server1')">Play Server 1</button>
  <button onclick="switchServer('server2')">Play Server 2</button>
  <button onclick="switchServer('server3')">Play Server 3</button>
</div>

<div class="quality-selector">
  <label for="quality-select">Select Quality:</label>
  <select id="quality-select"></select>
</div>

<div class="video-container">
  <video id="server1" controls playsinline></video>
  <video id="server2" controls playsinline></video>
  <video id="server3" controls playsinline></video>
</div>

<a class="button" href="tg://resolve?domain=SuperModsApk">Join Telegram Now</a>
</body>
</html>
